/work/sheidaei/conda/envs/mytorch/lib/python3.9/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1666643016022/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
Namespace(volume_path='/work/sheidaei/mhashemi/data/deg', dataset='Degradation', num_classes=2, list_dir='./lists/lists_Degradation', max_iterations=288, max_epochs=1, batch_size=24, img_size=[160, 160, 160], is_savenii=False, world_size=-1, rank=-1, dist_url='env://', dist_backend='nccl', local_rank=-1, n_skip=4, vit_name='Conv-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.01, seed=1234, vit_patches_size=8, Dataset=<class 'datasets.dataset_deg.Degradation_dataset'>, z_spacing=1, is_pretrain=True, exp='TV_Degradation[160, 160, 160]', distributed=False)
TU_pretrain_Conv-ViT-B_16_skip4_vitpatch8_28k_epo1_bs24_[160, 160, 160]
30 test iterations per epoch
0it [00:00, ?it/s]0it [01:23, ?it/s]
Traceback (most recent call last):
  File "/home/mhashemi/TransUNet/test_deg.py", line 205, in <module>
    inference(args, model, test_save_path)
  File "/home/mhashemi/TransUNet/test_deg.py", line 71, in inference
    metric_batch = test_multiple_volumes(image_batch, label_batch, time_batch, model, classes=args.num_classes, patch_size=args.img_size,
  File "/home/mhashemi/TransUNet/utils.py", line 140, in test_multiple_volumes
    metric_i += calculate_metric_percase(prediction[batch_sample, ...] == i, label[batch_sample, ...] == i)
  File "/home/mhashemi/TransUNet/utils.py", line 52, in calculate_metric_percase
    dice = metric.binary.dc(pred, gt)
  File "/work/sheidaei/conda/envs/mytorch/lib/python3.9/site-packages/medpy/metric/binary.py", line 69, in dc
    reference = numpy.atleast_1d(reference.astype(numpy.bool))
AttributeError: 'Tensor' object has no attribute 'astype'
