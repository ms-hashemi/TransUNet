/work/sheidaei/conda/envs/mytorch/lib/python3.9/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1666643016022/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
Namespace(volume_path='/work/sheidaei/mhashemi/data/deg', dataset='Degradation', num_classes=2, list_dir='./lists/lists_Degradation', max_iterations=288, max_epochs=1, batch_size=24, img_size=[160, 160, 160], is_savenii=False, world_size=-1, rank=-1, dist_url='env://', dist_backend='nccl', local_rank=-1, n_skip=4, vit_name='Conv-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.01, seed=1234, vit_patches_size=8, Dataset=<class 'datasets.dataset_deg.Degradation_dataset'>, z_spacing=1, is_pretrain=True, exp='TV_Degradation[160, 160, 160]', distributed=False)
TU_pretrain_Conv-ViT-B_16_skip4_vitpatch8_28k_epo1_bs24_[160, 160, 160]
30 test iterations per epoch
0it [00:00, ?it/s]1it [01:42, 102.41s/it]2it [02:10, 58.62s/it] 3it [02:38, 44.62s/it]4it [03:06, 38.18s/it]5it [03:34, 34.48s/it]6it [04:02, 32.15s/it]7it [04:29, 30.58s/it]8it [04:55, 29.11s/it]9it [05:21, 28.16s/it]10it [05:49, 28.05s/it]11it [06:16, 27.89s/it]12it [06:42, 27.16s/it]13it [07:07, 26.68s/it]14it [07:32, 26.08s/it]15it [07:56, 25.39s/it]16it [08:25, 26.40s/it]17it [08:53, 26.99s/it]18it [09:21, 27.35s/it]19it [09:50, 27.66s/it]20it [10:18, 27.89s/it]21it [10:47, 28.13s/it]22it [11:15, 28.24s/it]23it [11:43, 28.12s/it]24it [12:10, 27.84s/it]25it [12:39, 28.02s/it]26it [13:07, 28.06s/it]27it [13:33, 27.59s/it]28it [14:00, 27.18s/it]29it [14:24, 26.47s/it]30it [14:48, 25.69s/it]30it [14:48, 29.63s/it]
Traceback (most recent call last):
  File "/home/mhashemi/TransUNet/test_deg.py", line 205, in <module>
    inference(args, model, test_save_path)
  File "/home/mhashemi/TransUNet/test_deg.py", line 77, in inference
    logging.info('Mean class %d mean_dice %f mean_hd95 %f' % (i, metric_list[i-1][0], metric_list[i-1][1]))
IndexError: invalid index to scalar variable.
