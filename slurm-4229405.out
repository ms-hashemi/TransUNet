NODELIST=novagpu015
MASTER_ADDR=novagpu015
export TMOUT=5400
export TMPDIR=/mnt/bgfs/mhashemi/4229405
export PTMPDIR=/mnt/bgfs/mhashemi/4229405/ptmp
[W socket.cpp:426] [c10d] The server socket cannot be initialized on [::]:12349 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [novagpu015]:12349 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [novagpu015]:12349 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [novagpu015]:12349 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [novagpu015]:12349 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [novagpu015]:12349 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [novagpu015]:12349 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [novagpu015]:12349 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [novagpu015]:12349 (errno: 97 - Address family not supported by protocol).
/work/sheidaei/conda/envs/mytorch/lib/python3.9/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1666643016022/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/work/sheidaei/conda/envs/mytorch/lib/python3.9/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1666643016022/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/work/sheidaei/conda/envs/mytorch/lib/python3.9/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1666643016022/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/work/sheidaei/conda/envs/mytorch/lib/python3.9/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1666643016022/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
Namespace(root_path='/work/sheidaei/mhashemi/data/deg', dataset='Degradation', list_dir='./lists/lists_Degradation', num_classes=2, max_iterations=288, max_epochs=1, batch_size=24, gpu=1, world_size=4, rank=1, dist_url='env://', dist_backend='nccl', local_rank=-1, deterministic=1, base_lr=0.01, img_size=[160, 160, 160], seed=1234, n_skip=4, vit_name='Conv-ViT-B_16', vit_patches_size=8, is_pretrain=True, exp='TV_Degradation[160, 160, 160]', distributed=True)
Traceback (most recent call last):
  File "/home/mhashemi/TransUNet/train_deg.py", line 152, in <module>
Namespace(root_path='/work/sheidaei/mhashemi/data/deg', dataset='Degradation', list_dir='./lists/lists_Degradation', num_classes=2, max_iterations=288, max_epochs=1, batch_size=24, gpu=2, world_size=4, rank=2, dist_url='env://', dist_backend='nccl', local_rank=-1, deterministic=1, base_lr=0.01, img_size=[160, 160, 160], seed=1234, n_skip=4, vit_name='Conv-ViT-B_16', vit_patches_size=8, is_pretrain=True, exp='TV_Degradation[160, 160, 160]', distributed=True)
Traceback (most recent call last):
  File "/home/mhashemi/TransUNet/train_deg.py", line 152, in <module>
Namespace(root_path='/work/sheidaei/mhashemi/data/deg', dataset='Degradation', list_dir='./lists/lists_Degradation', num_classes=2, max_iterations=288, max_epochs=1, batch_size=24, gpu=3, world_size=4, rank=3, dist_url='env://', dist_backend='nccl', local_rank=-1, deterministic=1, base_lr=0.01, img_size=[160, 160, 160], seed=1234, n_skip=4, vit_name='Conv-ViT-B_16', vit_patches_size=8, is_pretrain=True, exp='TV_Degradation[160, 160, 160]', distributed=True)
Namespace(root_path='/work/sheidaei/mhashemi/data/deg', dataset='Degradation', list_dir='./lists/lists_Degradation', num_classes=2, max_iterations=288, max_epochs=1, batch_size=24, gpu=0, world_size=4, rank=0, dist_url='env://', dist_backend='nccl', local_rank=-1, deterministic=1, base_lr=0.01, img_size=[160, 160, 160], seed=1234, n_skip=4, vit_name='Conv-ViT-B_16', vit_patches_size=8, is_pretrain=True, exp='TV_Degradation[160, 160, 160]', distributed=True)
Traceback (most recent call last):
  File "/home/mhashemi/TransUNet/train_deg.py", line 152, in <module>
The length of train set is: 288
Traceback (most recent call last):
  File "/home/mhashemi/TransUNet/train_deg.py", line 152, in <module>
    trainer[dataset_name](args, model, snapshot_path)
  File "/home/mhashemi/TransUNet/trainer.py", line 121, in trainer_deg
    train_sampler = distributed.DistributedSampler(dataset, shuffle=True)
NameError: name 'dataset' is not defined
    trainer[dataset_name](args, model, snapshot_path)
  File "/home/mhashemi/TransUNet/trainer.py", line 121, in trainer_deg
    train_sampler = distributed.DistributedSampler(dataset, shuffle=True)
NameError: name 'dataset' is not defined
    trainer[dataset_name](args, model, snapshot_path)
  File "/home/mhashemi/TransUNet/trainer.py", line 121, in trainer_deg
    train_sampler = distributed.DistributedSampler(dataset, shuffle=True)
NameError: name 'dataset' is not defined
    trainer[dataset_name](args, model, snapshot_path)
  File "/home/mhashemi/TransUNet/trainer.py", line 121, in trainer_deg
    train_sampler = distributed.DistributedSampler(dataset, shuffle=True)
NameError: name 'dataset' is not defined
srun: error: novagpu015: task 0: Exited with exit code 1
srun: error: novagpu015: tasks 1,3: Exited with exit code 1
srun: error: novagpu015: task 2: Exited with exit code 1
